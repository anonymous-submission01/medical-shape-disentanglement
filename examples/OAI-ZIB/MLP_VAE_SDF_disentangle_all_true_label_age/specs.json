{
  "Description": [
    "Residual MLP VAE + DeepSDF latent distillation.",
    "Teacher latents come from a pretrained DeepSDF experiment."
  ],
  "Notes": [
    "Switch to age regression: LabelTaskType=regression, LabelIndex=1, SAPLabelIndices=[1], SAPRegression=true, SAPContinuousFactors=true, SNNLType=reg_exact.",
    "Switch to disease classification: LabelTaskType=classification, LabelIndex=0, SAPLabelIndices=[0], SAPRegression=false, SAPContinuousFactors=false, SNNLType=cls.",
    "Use EncoderType=residual_mlp to feed 256D latents (no surface points). Provide TestLatentPath for test eval; ReturnSurfacePoints is ignored."
  ],
  "DataSource": "[path to sdf folder: mesh_minimal_scaled_obj_files]",
  "DataSourceMesh": "[path to mesh folder: mesh_minimal_scaled_obj_files]",
  "TrainSplit": "examples/splits/splits_OAI_Femur_new_all/train_split_torus.json",
  "TestSplit": "examples/splits/splits_OAI_Femur_new_all/test_split_torus.json",
  "EvalTrainFrequency": 100,
  "EvalTestFrequency": 100,
  "NetworkArch": "deep_sdf_decoder",
  "NetworkSpecs": {
    "dims": [
      512,
      512,
      512,
      512,
      512,
      512,
      512,
      512
    ],
    "dropout": [],
    "dropout_prob": 0.2,
    "norm_layers": [],
    "latent_in": [
      4
    ],
    "xyz_in_all": false,
    "use_tanh": false,
    "latent_dropout": false,
    "weight_norm": true
  },
  "CodeLength": 256,
  "NumEpochs": 2000,
  "SnapshotFrequency": 100,
  "AdditionalSnapshots": [
    100,
    500
  ],
  "LearningRateSchedule": [
    {
      "Type": "Step",
      "Initial": 0.0005,
      "Interval": 500,
      "Factor": 0.5
    },
    {
      "Type": "Step",
      "Initial": 0.0001,
      "Interval": 500,
      "Factor": 0.5
    }
  ],
  "SamplesPerScene": 16384,
  "ScenesPerBatch": 32,
  "DataLoaderThreads": 16,
  "ClampingDistance": 0.1,
  "GradientClipNorm": 1.0,
  "LoadDatasetIntoRAM": false,
  "ReturnSurfacePoints": true,
  "SurfacePointCount": 3000,
  "PretrainedLatentPath": "../minimal_eikonal/LatentCodes/latents_by_name.pt",
  "PretrainedSDFDecoderPath": "../minimal_eikonal/ModelParameters/latest.pth",
  "TrainSDFDecoder": false,
  "SDFLossWeight": 1.0,
  "CodeRegularization": true,
  "CodeRegularizationLambda": 0.0001,
  "CodeRegularizationWarmupEpochs": 100,
  "VAEInputDim": 256,
  "VAELatentDim": 8,
  "EncoderType": "residual_mlp",
  "VAEEncoderHiddenDims": [
    256,
    128
  ],
  "VAEDecoderHiddenDims": [
    128,
    256,
    256
  ],
  "VAEBlocks": 1,
  "VAEActivation": "gelu",
  "VAEDropout": 0.0,
  "VAELayerNorm": true,
  "VAEReconLoss": "mse",
  "VAEReconWeight": 0.1,
  "VAEKLWeight": 0.01,
  "UseKLLoss": true,
  "KLWarmupEpochs": 100,
  "LabelTaskType": "classification",
  "GuidedContrastiveLoss": true,
  "AttributeLoss": false,
  "SNNLType": "cls",
  "SNNLTemp": 10.0,
  "SNNLWeight": 0.5,
  "SNNLTargetDim": 0,
  "SNNLRegThreshold": 0.2,
  "SNNLRegPosMode": "topk",
  "SNNLRegTopkFrac": 0.1,
  "SNNLRegUseAdaptiveT": true,
  "SNNLRegNormalizeZ": true,
  "AgeSNNLRegLoss": true,
  "AgeSNNLRegWeight": 0.5,
  "AgeSNNLRegLabelIndex": 3,
  "AgeSNNLRegTargetDim": 1,
  "AgeSNNLRegTemp": 10.0,
  "AgeSNNLRegThreshold": 0.2,
  "AgeSNNLRegPosMode": "topk",
  "AgeSNNLRegTopkFrac": 0.1,
  "AgeSNNLRegUseAdaptiveT": true,
  "AgeSNNLRegNormalizeZ": true,
  "AttributeWeight": 0.25,
  "LabelIndex": 0,
  "AttributeLatentIndex": 0,
  "ReturnLabels": true,
  "WarnMissingLabels": true,
  "LabelsFile": "labels_normalized.pt",
  "ComputeSAP": true,
  "SAPRegression": false,
  "ComputeDCI": false,
  "ComputeMIG": false,
  "SAPLabelIndices": [
    0
  ],
  "ComputeSAPAge": true,
  "SAPAgeLabelIndices": [
    3
  ],
  "SAPAgeRegression": true,
  "SAPAgeContinuousFactors": true,
  "SAPAgeNumBins": 10,
  "SAPAgeCORRLabelsFile": "labels_normalized.pt",
  "SAPContinuousFactors": false,
  "SAPDebugPredictions": false,
  "SAPDebugPredSamples": 0,
  "SAPKumarHoldout": true,
  "SAPKumarHoldoutFrac": 0.8,
  "SAPKumarHoldoutSeed": 0,
  "SAPCORRLabelsFile": "labels_normalized.pt",
  "SAPCORRExtraFrequency": 0,
  "LatentExportBatchSize": 1024,
  "EvalTestSceneNumber": 77,
  "EvalTestReconstructLatents": false,
  "EvalTestStartEpoch": 1,
  "CovarianceLoss": true,
  "CovarianceLossLambda": 0.2,
  "LabelMixing": false,
  "LabelMixStratified": true,
  "PseudoLabelsFile": "pseudo_label_gmm_normalized.pt",
  "RealLabelsFile": "labels_normalized.pt",
  "LabelMixPseudoRatioStart": 0.0,
  "LabelMixUnlabeledRatioStart": 0.0,
  "TestLatentPath": "../minimal_eikonal/LatentCodes/latents_by_name.pt",
  "EvalMeshTestSceneNumber": 2,
  "EvalGTMeshDir": "[path to mesh folder: mesh_minimal_scaled_obj_files]",
  "EvalGTMeshExt": ".obj",
  "CorrLeakageLoss": true,
  "CorrLeakageLambda": 0.05,
  "CrossCovLoss": true,
  "CrossCovLambda": 0.05,
  "LeakageTargetDim": 0,
  "EvalTrainSceneNumber": 100,
  "EvalMeshTrainSceneNumber": 2,
  "TrainLatentHoldoutFraction": 0.1,
  "TrainLatentHoldoutSeed": 0,
  "SensitivityLoss": true,
  "SensitivityEps": 0.02,
  "SensitivityEta": 0.02,
  "SensitivityWeight": 0.5,
  "SensitivityLatentIndex": 0,
  "RankLoss": true,
  "RankLossMargin": 0.5,
  "RankLossTargetDim": 0,
  "RankLossCNLabel": 0,
  "RankLossWeight": 0.1,
  "MatchStdLoss": true,
  "MatchStdWeight": 0.1,
  "MatchStdTargetDim": 0,
  "MatchStdEps": 1e-06,
  "ValSplit": "examples/splits/splits_OAI_Femur_new_all/val_split_torus.json",
  "ValLatentPath": "../minimal_eikonal/LatentCodes/latents_by_name.pt",
  "AgeLabelIndexForTable": 3,
  "PretrainedVAEPath": "ModelParameters/latest.pth"
}